-------------Regression---------------------
-- Training data
CREATE OR REPLACE TABLE
    test.public.time_series(
        ds DATE, 
        metric NUMBER,
        dim_country VARCHAR,
        dim_vertical VARCHAR
    );

INSERT INTO 
    time_series
SELECT 
    DATEADD(DAY, SEQ4(), DATE_FROM_PARTS(2020,4,1)) AS ds,
    UNIFORM(1,10,RANDOM()) AS metric,
    'usa' AS dim_country,
    'tech' AS dim_vertical
FROM
    TABLE(GENERATOR(ROWCOUNT => 365));

SELECT 
    *
FROM 
   time_series
LIMIT 
    10;

INSERT INTO 
    time_series
SELECT 
    DATEADD(DAY, SEQ4(), DATE_FROM_PARTS(2020,4,1)) AS ds,
    UNIFORM(1,10,RANDOM()) AS metric,
    'usa' AS dim_country,
    'auto' AS dim_vertical
FROM
    TABLE(GENERATOR(ROWCOUNT => 365));


SELECT 
    *
FROM 
   time_series
LIMIT 
    10;

INSERT INTO 
    time_series
SELECT 
    DATEADD(DAY, SEQ4(), DATE_FROM_PARTS(2020,4,1)) AS ds,
    UNIFORM(1,10,RANDOM()) AS metric,
    'usa' AS dim_country,
    'fashion' AS dim_vertical
FROM
    TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'usa' AS dim_country,
    'finance' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));
  
INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'canada' AS dim_country,
    'fashion' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'canada' AS dim_country,
    'finance' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'canada' AS dim_country,
    'tech' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'canada' AS dim_country,
    'auto' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'france' AS dim_country,
    'fashion' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'france' AS dim_country,
    'finance' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'france' AS dim_country,
    'tech' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 4, 1)) AS ds,
    UNIFORM(1, 10, RANDOM()) AS metric,
    'france' AS dim_country,
    'auto' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

-- test data
INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 8, 1)) AS ds,
    UNIFORM(300, 320, RANDOM()) AS metric,
    'usa' AS dim_country,
    'auto' AS dim_vertica
  FROM 
    TABLE(GENERATOR(ROWCOUNT => 365));

INSERT INTO time_series
  SELECT
    DATEADD(day, SEQ4(), DATE_FROM_PARTS(2020, 8, 1))  AS ds,
    UNIFORM(400, 420, RANDOM()) AS metric,
    'usa' AS dim_country,
    'finance' AS dim_vertical
  FROM TABLE(GENERATOR(ROWCOUNT => 365));

SELECT
    *
FROM 
  time_series;

-------------Classification---------------------

CREATE OR REPLACE TABLE 
    purchase AS (
        SELECT 
            CAST(UNIFORM(0,4,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(0,3,RANDOM()) AS rating,
            FALSE AS label,
            'not_interested' AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
        UNION ALL
        SELECT 
            CAST(UNIFORM(4,7,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(3,7,RANDOM()) AS rating,
            FALSE AS label,
            'add_to_wishlist' AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
        UNION ALL
        SELECT 
            CAST(UNIFORM(7,10,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(7,10,RANDOM()) AS rating,
            FALSE AS label,
            'purchase' AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
        UNION ALL
        SELECT 
            CAST(UNIFORM(0,4,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(0,3,RANDOM()) AS rating,
            NULL AS label,
            NULL AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
        UNION ALL
        SELECT 
            CAST(UNIFORM(4,7,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(3,7,RANDOM()) AS rating,
            NULL AS label,
            NULL AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
        UNION ALL
        SELECT 
            CAST(UNIFORM(7,10,RANDOM()) AS VARCHAR) AS interest,
            UNIFORM(7,10,RANDOM()) AS rating,
            NULL AS label,
            NULL AS class
        FROM 
            TABLE(GENERATOR(ROWCOUNT =>100))
    );

SELECT 
    *
FROM 
    PURCHASE;